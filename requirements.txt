# =============================================================================
# JAX 核心依赖
# =============================================================================
# JAX 生态系统，带版本约束确保稳定性
jax>=0.4.20,<0.5.0
jaxlib>=0.4.20,<0.5.0

# JAX-MD 用于可选的高级图操作（如果后续需要的话）
# 注意：仅在计划使用高级分子动力学功能时安装
# jax-md>=0.2.7

# =============================================================================
# 神经网络框架
# =============================================================================
# Flax 用于 JAX 神经网络（兼容 JAX 0.4.x）
flax>=0.7.4,<0.8.0

# Optax 提供 JAX 兼容的优化器  
optax>=0.1.7,<0.2.0

# Jraph 用于图神经网络
jraph>=0.0.6.dev0

# =============================================================================
# 可微分二次规划求解器
# =============================================================================
# QPax 用于可微分二次规划求解（核心需求）
qpax>=0.0.3

# =============================================================================
# 配置管理
# =============================================================================
# ML Collections 用于结构化配置
ml_collections>=0.1.1

# OmegaConf 作为 ml_collections 的替代/补充
omegaconf>=2.3.0

# =============================================================================
# 科学计算核心
# =============================================================================
# NumPy - 坚持使用与 JAX 兼容的稳定版本
numpy>=1.24.0,<1.27.0

# SciPy 用于科学计算
scipy>=1.10.0,<1.12.0

# =============================================================================
# 数据处理和可视化
# =============================================================================
# Matplotlib 用于绘图和可视化
matplotlib>=3.6.0

# Seaborn 用于统计可视化
seaborn>=0.12.0

# Pandas 用于数据处理
pandas>=1.5.0

# TQDM 用于进度条显示
tqdm>=4.64.0

# =============================================================================
# 测试和开发工具
# =============================================================================
# Pytest 测试框架
pytest>=7.0.0
pytest-cov>=4.0.0

# 代码格式化和检查
black>=22.0.0
isort>=5.10.0

# =============================================================================
# 日志记录和实验追踪
# =============================================================================
# TensorBoard 用于日志记录
tensorboard>=2.10.0

# Weights & Biases 用于实验追踪  
wandb>=0.13.0

# =============================================================================
# 文件输入输出和序列化
# =============================================================================
# HDF5 支持
h5py>=3.7.0

# 注意：已移除 pickle5 - Python 3.8+ 原生包含 pickle protocol 5
# pickle5 包仅在 Python < 3.8 时需要
# 由于我们使用现代 Python，原生 pickle 模块就足够了

# =============================================================================
# 实用工具
# =============================================================================
# Click 用于命令行界面
click>=8.1.0

# Rich 用于美化终端输出
rich>=12.0.0

# Chex 用于 JAX 测试工具
chex>=0.1.7

# PSUtil 用于系统内存监控
psutil>=5.9.0

# =============================================================================
# 增强功能的可选依赖
# =============================================================================
# 如果计划使用高级功能，请取消这些注释：

# 用于高级3D渲染（如果需要复杂可视化）
# trimesh>=3.21.0
# pyrender>=0.1.45

# 用于额外的数学工具
# jaxopt>=0.6.0

# 用于高级优化算法
# optuna>=3.0.0  # 超参数优化

# =============================================================================
# 平台相关说明
# =============================================================================
# Windows 用户：确保安装了 Visual Studio Build Tools
# macOS 用户：确保安装了 Xcode command line tools  
# Linux 用户：确保安装了 build-essential

# 如果遇到 jaxlib 的 CUDA 问题：
# pip install "jax[cuda11_pip]" -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html
# 或者对于 CUDA 12：
# pip install "jax[cuda12_pip]" -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html